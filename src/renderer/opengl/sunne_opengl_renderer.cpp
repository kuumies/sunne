/* ---------------------------------------------------------------- *
   Antti Jumpponen <kuumies@gmail.com>
   Implementation of kuu::sunne::OpenGLRenderer class.
 * ---------------------------------------------------------------- */

#include "sunne_opengl_renderer.h"
#include <glad/glad.h>

namespace kuu
{
namespace sunne
{

/* ---------------------------------------------------------------- *
 * ---------------------------------------------------------------- */
struct OpenGLRenderer::OpenGLRenderer::Impl
{
    /* ------------------------------------------------------------ *
     * ------------------------------------------------------------ */
    Impl(const glm::ivec2& size)
        : size(size)
    {}

    /* ------------------------------------------------------------ *
     * ------------------------------------------------------------ */
    void resize(const glm::ivec2& newSize)
    {
        size = newSize;
    }

    /* ------------------------------------------------------------ *
     * ------------------------------------------------------------ */
    void render()
    {
        glEnable(GL_DEPTH_TEST);
        glClearColor(0.2f, 0.2f, 0.2f, 1.0f);
        glViewport(0, 0, size.x, size.y);
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    }

    /* ------------------------------------------------------------ *
     * ------------------------------------------------------------ */
    glm::ivec2 size;
};

/* ---------------------------------------------------------------- *
 * ---------------------------------------------------------------- */
OpenGLRenderer::OpenGLRenderer(const glm::ivec2& size)
    : impl(std::make_shared<Impl>(size))
{}

/* ---------------------------------------------------------------- *
 * ---------------------------------------------------------------- */
void OpenGLRenderer::resize(const glm::ivec2& size)
{ impl->resize(size); }

/* ---------------------------------------------------------------- *
 * ---------------------------------------------------------------- */
void OpenGLRenderer::render()
{ impl->render(); }

} // namespace sunne
} // namespace kuu
